<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Pandemic Detection System</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/index.css">
</head>
<body>
    <header class="site-header">
        <div class="header-inner">
            <a class="brand" href="index.html" aria-label="Pandemic Detection Home">Pandemic Detection</a>

            <button class="nav-toggle" id="navToggle" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
                â˜°
            </button>

            <nav id="mainNav" class="main-nav" role="navigation" aria-label="Main menu">
                <ul>
                    <li><a href="index.html" class="active">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="ai_detection.html">AI Detection</a></li>
                    <li><a href="subscription.html">Subscription</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="hero-wrap" role="main">
        <section class="hero">
            <div class="hero-content">
                <!-- Welcome message dynamically added here -->
                <h1 id="welcomeMessage">Welcome!</h1>
                <p class="lead">Using AI and machine learning to detect pandemic outbreaks before they spread. Fast, privacy-first, clinically-minded.</p>
                <div class="hero-ctas">
                    <a href="ai_detection.html" class="cta-button primary">Try AI Detection</a>
                    <a href="subscription.html" class="cta-button ghost">Get Started</a>
                </div>
            </div>
            <div class="hero-media" aria-hidden="true">
                <img src="images/healthcare.jpg" alt="Healthcare AI illustration">
            </div>
        </section>

        <section class="features" aria-labelledby="features-title">
            <h2 id="features-title">Why Choose Our System?</h2>
            <div class="feature-grid">
                <article class="feature-box">
                    <h3>AI-Powered Detection</h3>
                    <p>Advanced models flag concerning symptom patterns early, helping teams act fast.</p>
                </article>
                <article class="feature-box">
                    <h3>Real-Time Monitoring</h3>
                    <p>Live dashboards and alerts keep you informed about evolving risk areas.</p>
                </article>
                <article class="feature-box">
                    <h3>User Alerts</h3>
                    <p>Receive privacy-preserving notifications if exposure risk is detected.</p>
                </article>
            </div>
        </section>
    </main>

    <footer class="site-footer" role="contentinfo">
        <p>&copy; <span id="year"></span> Pandemic Detection System | Protecting Lives with Technology</p>
        <button id="logoutBtn" class="btn ghost logout-btn">Logout</button>
    </footer>

    <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBHTTbLJbKUbvIj7amzeCmsRMKT5UtaknE",
        authDomain: "pandemic-health.firebaseapp.com",
        projectId: "pandemic-health",
        storageBucket: "pandemic-health.appspot.com",
        messagingSenderId: "80746170325",
        appId: "1:80746170325:web:2ec82c7c1711a38be85f5c"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const welcomeMessage = document.getElementById('welcomeMessage');
    const logoutBtn = document.getElementById('logoutBtn');

    // Listen for auth state changes
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            // Fetch user data from Firestore
            const userDoc = await getDoc(doc(db, 'users', user.uid));
            if (userDoc.exists()) {
                const userData = userDoc.data();
                welcomeMessage.textContent = `Welcome, ${userData.name}!`;
            }
        } else {
            // Redirect to login if not logged in
            window.location.href = 'login.html';
        }
    });

    // Logout functionality
    logoutBtn.addEventListener('click', async () => {
        try {
            await signOut(auth);
            window.location.href = 'login.html';
        } catch (err) {
            console.error('Error logging out:', err.message);
        }
    });

    // Update year dynamically
    const y = new Date().getFullYear();
    document.getElementById('year').textContent = y;
    </script>
</body>
</html>
